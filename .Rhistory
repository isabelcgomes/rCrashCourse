if(!require(pacman)) install.packages("pacman")
library(pacman)
pacman :: p_load(dplyr, psych, car, MASS, DescTools, QUantPsyc, ggplot2)
dados <- read.excel('./dados/Dados.xls',
fileEncoding = 'latin1', sep=',')
dados <- read_excel('./dados/Dados.xls',
fileEncoding = 'latin1', sep=',')
library(readxl)
dados <- read_excel('./dados/Dados.xls',
fileEncoding = 'latin1', sep=',')
dados <- read_excel('./dados/Dados.xls')
setwd("C:/Users/Isabel Giannecchini/Desktop/SSD/rCrashCourse")
dados <- read_excel('/dados/Dados.xls')
dados <- read_excel('dados/Dados.xls')
colnames(dados) <- c('Estresse', 'Fuma', 'Cancer','drop1', 'drop2')
dados <- read_excel('dados/Dados.xls')
colnames(dados) <- c('Estresse', 'Fuma', 'Cancer')
View(dados)
glimpse(dados)
table(dados$Cancer)
summary(dados)
levels(dados$Cancer)
plot(dados$Estresse, dados$Cancer)
table(dados$Cancer)
glimpse(dados)
summary(dados)
plot(dados$Estresse, dados$Cancer)
pairs.panels(dados)#Correlação de pearson
vif(mod) #fator de variância de inflação
mod<-glm(Cancer ~ Estresse + Fuma,
family = binomial(link = 'logit'), data = dados)
levels(dados$Cancer)
levels(dados$Fuma)
dados <- read_excel('dados/Dados.xls')
levels(dados$Hab_Fumar)
mod<-glm(Cancer ~ Estresse + Fuma,
family = binomial(link = 'logit'), data = dados)
dados <- read_excel('dados/Dados.xls', strig2factors())
dados <- read_excel('dados/Dados.xls', string2factors())
dados <- mutate(dados, across(where(is.character), as.factor))
mod<-glm(Cancer ~ Estresse + Fuma,
family = binomial(link = 'logit'), data = dados)
dados <- read_excel('dados/Dados.xls', string2factors())
colnames(dados) <- c('Estresse', 'Fuma', 'Cancer')
dados <- mutate(dados, across(where(is.character), as.factor))
View(dados)
glimpse(dados)
table(dados$Cancer)
summary(dados)
plot(dados$Estresse, dados$Cancer)
levels(dados$Cancer)
levels(dados$Fuma)
mod<-glm(Cancer ~ Estresse + Fuma,
family = binomial(link = 'logit'), data = dados)
plot(mod, which = 5)
plot(mod, which = 5)
summary(stdres(mod))
pairs.panels(dados)#Correlação de pearson
vif(mod) #fator de variância de inflação
intlog <- dados$Estresse * log(dados$Estresse)
dados$intlog <- intlog
modint <- glm(Cancer ~ Fuma + Estresse + intlog,
family = binomial(link = 'logit'),
data = dados)
logito <- mod$linear.predictors
prob <- predict(mod, type = 'response')
dados$logito <- logito
#outra forma de calcular o logitto:
prob <- predict(mod, type = 'response')
logito2 <- log(prob/(1-prob))
ggplot(dados, aes(logito, Estresse)) +
geom_point(size=0.5, alpha=0.5) +
geom_smooth(method = 'loess') +
theme_classic()
Anova(mod, type = 'II', test= 'Wald')
summary(mod)
exp(OR = coef(mod), confint(mod))
exp(cbind(OR = coef(mod), confint(mod)))
exp(coef(mod))
exp(cbind(OR = coef(mod), confint.default(mod)))
mod2 <- glm(Cancer ~ Fuma,
family = binomial(link = 'logit'),
data = dados)
Anova(mod2, type = 'II', test= 'Wald')
summary(mod2)
exp(cbind(OR=coef(mod2), cofint(mod2)))
exp(cbind(OR=coef(mod2), confint(mod2)))
PseudoR2(mod, which = 'Nagelkerke')
PseudoR2(mod2, which = 'Nagelkerke')
AIC(mod, mod2)
AIC(mod, mod2)
BIC(mod, mod2)
anova(mod2, mod, test='Chisq')
ClassLog(mod, dados$Cancer)
ClassLog(mod, dados$Cancer)
ClassLog(MOD = mod, dados$Cancer)
table(dados$Cancer)
table(dados$Cancer ~ Fuma)
table(dados$Cancer ~ dados$Fuma)
table(dados$Cancer, dados$Fuma)
