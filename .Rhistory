library(pacman)
dados <- read.csv('dados/MOCK_DATA.csv', stringsAsFactors = TRUE,  fileEncoding = 'latin1' )
summary(dados)
library(pacman)
dados <- read.csv('dados/MOCK_DATA.csv', stringsAsFactors = TRUE,  fileEncoding = 'latin1' )
setwd("C:/Users/Isabel Giannecchini/Desktop/SSD/rCrashCourse")
dados <- read.csv('dados/MOCK_DATA.csv', stringsAsFactors = TRUE,  fileEncoding = 'latin1' )
summary(dados)
levels(dados$Voto)
levels(dados$Etnia)
#também é possível trocar a minha referência
dados$Etnia <- relevel(dados$Etnia, ref = "Ford")
levels(dados$Etnia)
psych::pairs.panels(dados[3:5])
m <- lm(as.numeric(Voto) ~ Etnia + ConfPol + LibEcon, data = dados)
car::vif(m) #Fator de variância de Inflação
library(mlogit)
library(dfidx)
library(nnet)
levels(dados$Voto)
unique(dados$Voto)
#iia = independência alternativa irrelevante
#modelo completo, intercepto igual a 1, formato wide, categoria de referência Donald Trump
modiia <- mlogit::mlogit(Voto ~ 1|Etnia + ConfPol + LibEcon, data = dados, shape = 'wide', refLevel = 'Amalle')
modiia2 <- mlogit::mlogit(Voto ~ 1|Etnia + ConfPol + LibEcon, data = dados, shape = 'wide', refLevel = 'Amalle', alt.subset = c('Amalle', 'Archibald'))
modiia2 <- mlogit::mlogit(Voto ~ 1|Etnia + ConfPol + LibEcon, data = dados, shape = 'wide', refLevel = 'Amalle', alt.subset = c('Amalle', 'Archibald'))
modiia2 <- mlogit::mlogit(Voto ~ 1|Etnia + ConfPol + LibEcon, data = dados, shape = 'wide', refLevel = 'Amalle', alt.subset = c('Amalle', 'Lisette'))
mod <- multinom(Voto ~ ConfPol + LibEcon + Etnia, data = dados, model=TRUE)
mod0 <- multinom(Voto ~ 1, data = dados, model = TRUE)
# Ajuste do modelo
anova(mod, mod0)
DescTools::PseudoR2(mod, which = 'Nagelkerke')
DescTools::PseudoR2(mod0, which = 'Nagelkerke')
car::Anova(mod, type = 'II', test='wald')
DescTools::PseudoR2(mod, which = 'Nagelkerke')
DescTools::PseudoR2(mod0, which = 'Nagelkerke')
car::Anova(mod, type = 'II', test='wald')
#Efeitos Específicos
summary(mod)
lmtest::coeftest(mod) #se o sinal é negativo a relação é inversamente proporcional, se for positivo, a tendência aumenta com o aumento daquela variável
exp(coef(mod))
exp(cofint(mod))
exp(coef(mod))
exp(confint(mod))
exp(coef(mod))
exp(confint(mod))
AIC(mod, mod2)
AIC(mod, mod0)
BIC(mod, mod0)
#Tabela de classificação, método de saber se o modleo está acertando
tab <- table(Observado = dados$Voto, Previsto=predict(mod))
tab
mod2 <- multinom(Voto ~ LibEcon + Etnia, data = dados, model=TRUE) #modelo sem a variável não significativa
AIC(mod, mod2)
BIC(mod, mod2)
#Tabela de classificação, método de saber se o modleo está acertando
tab <- table(Observado = dados$Voto, Previsto=predict(mod2))
tab
car::Anova(mod2, type = 'II', test='wald')
mod2 <- multinom(Voto ~ LibEcon + Etnia, data = dados, model=TRUE) #modelo sem a variável não significativa
car::Anova(mod2, type = 'II', test='wald')
summary(mod2)
lmtest::coeftest(mod2) #se o sinal é negativo a relação é inversamente proporcional, se for positivo, a tendência aumenta com o aumento daquela variável
AIC(mod, mod2)
BIC(mod, mod2)
#Tabela de classificação, método de saber se o modleo está acertando
tab <- table(Observado = dados$Voto, Previsto=predict(mod2))
tab
exp(coef(mod))
#menor que 0, as pessoas afirmam que não votariam nela
#maior que 1, as pessoas preferem votar nesse candidato do que no candidato da categoria de referência
exp(confint(mod))#maior que 0, menor que 1, as pessoas preferem votar no outro candidato
#esses dois são pmétodos para avaliar parcimônia, eu escolho sempre os de menor valor
#Quando a diferença é menor do que 10, não tem diferença real, então vai pelo princípio da parcimônia
Anova(mod2, mod, test='Chisq')
#esses dois são pmétodos para avaliar parcimônia, eu escolho sempre os de menor valor
#Quando a diferença é menor do que 10, não tem diferença real, então vai pelo princípio da parcimônia
car::Anova(mod2, mod, test='Chisq')
